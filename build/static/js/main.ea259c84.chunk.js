(this.webpackJsonpphylo_tree_viewer=this.webpackJsonpphylo_tree_viewer||[]).push([[0],{117:function(e,t,a){e.exports={files:"fileUpload_files__3hlEX",color:"fileUpload_color__3NmOi",error:"fileUpload_error__2O3UN",error_text:"fileUpload_error_text__1Lj4l"}},118:function(e,t,a){e.exports={container:"loadingPage_container__QqvoI",spinner:"loadingPage_spinner__1M5fI",text:"loadingPage_text__2XKRt"}},191:function(e,t,a){e.exports={title:"App_title__1ysuK"}},360:function(e,t){},379:function(e,t,a){},380:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a(0),r=a.n(n),o=a(74),s=a.n(o),i=a(17),l=a(112),d=a(14),j=a(191),b=a.n(j),u=a(18),O=a(8),x=a(6),m=a(11),h=a(78),f=a(197),v=a(202),p=a(19),g=a(55),C=a(194),y=a.n(C),_=a(200),k=a(87),D=a.n(k);var N=function(e){var t=e.index,a=e.color,n=e.setCladeProperties,o=r.a.useState(!1),s=Object(i.a)(o,2),l=s[0],d=s[1],j=function(){return d(!l)};return Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:D.a.swatch,onClick:j,children:Object(c.jsx)("div",{className:D.a.color,style:{background:a}})}),l?Object(c.jsxs)("div",{className:D.a.popover,children:[Object(c.jsx)("div",{className:D.a.cover,onClick:j}),Object(c.jsx)(_.a,{color:a,onChange:function(e){n((function(a){return Object(u.a)(Object(u.a)({},a),{},Object(O.a)({},t,Object(u.a)(Object(u.a)({},a[t]),{},{color:e.hex})))}))}})]}):null]})},F=function(e,t,a,c,n){return function(){for(var r=Object.keys(t).length,o=Object(u.a)({},t),s=parseInt(e);s<Object.keys(t).length-1;s++){o[s]=Object(u.a)({},o[s+1]);for(var i=0,l=Object.keys(o[s]);i<l.length;i++){var d=l[i];c("".concat(d).concat(s),o[s][d])}}delete o[r-1],n({}),a(o)}},q=function(e,t,a,c){return function(n){c("".concat(t).concat(e),n.target.value),a((function(a){return Object(u.a)(Object(u.a)({},a),{},Object(O.a)({},e,Object(u.a)(Object(u.a)({},a[e]),{},Object(O.a)({},t,n.target.value))))}))}},V=function(e){var t=e.cladeProperties,a=e.setCladeProperties,n=e.index,r=e.clade,o=e.minDensity,s=e.maxDensity,i=e.minCoverage,l=e.maxCoverage,d=e.color,j=e.setFieldValue,b=e.errors,u=e.touched,O=e.setTouched;return Object(c.jsxs)(x.a.Row,{className:"mb-2 mt-2",children:[Object(c.jsxs)(m.a,{xs:12,md:2,children:[Object(c.jsx)(x.a.Control,{type:"text",placeholder:"Clade name",name:"".concat(r).concat(n),value:t[n][r]||"",onChange:q(n,r,a,j),isValid:!b["".concat(r).concat(n)]&&u["".concat(r).concat(n)],isInvalid:!!b["".concat(r).concat(n)]&&u["".concat(r).concat(n)]}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:b["".concat(r).concat(n)]})]}),Object(c.jsxs)(m.a,{xs:12,md:1,children:[Object(c.jsx)(N,{index:n,color:t[n][d],setCladeProperties:a}),Object(c.jsx)(x.a.Control.Feedback,{children:b.color})]}),Object(c.jsxs)(m.a,{xs:12,md:2,children:[Object(c.jsx)(x.a.Control,{type:"text",placeholder:"Min Density",name:"".concat(o).concat(n),value:t[n][o],onChange:q(n,o,a,j),isValid:!b["".concat(o).concat(n)]&&u["".concat(o).concat(n)],isInvalid:!!b["".concat(o).concat(n)]&&u["".concat(o).concat(n)]}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:b["".concat(o).concat(n)]})]}),Object(c.jsxs)(m.a,{xs:12,md:2,children:[Object(c.jsx)(x.a.Control,{type:"text",placeholder:"Max Density",name:"".concat(s).concat(n),value:t[n][s],onChange:q(n,s,a,j),isValid:!b["".concat(s).concat(n)]&&u["".concat(s).concat(n)],isInvalid:!!b["".concat(s).concat(n)]&&u["".concat(s).concat(n)]}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:b["".concat(s).concat(n)]})]}),Object(c.jsxs)(m.a,{xs:12,md:2,children:[Object(c.jsx)(x.a.Control,{type:"text",placeholder:"Min Coverage",name:"".concat(i).concat(n),value:t[n][i],onChange:q(n,i,a,j),isValid:!b["".concat(i).concat(n)]&&u["".concat(i).concat(n)],isInvalid:!!b["".concat(i).concat(n)]&&u["".concat(i).concat(n)]}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:b["".concat(i).concat(n)]})]}),Object(c.jsxs)(m.a,{xs:12,md:2,children:[Object(c.jsx)(x.a.Control,{type:"text",placeholder:"Max Coverage",name:"".concat(l).concat(n),value:t[n][l],onChange:q(n,l,a,j),isValid:!b["".concat(l).concat(n)]&&u["".concat(l).concat(n)],isInvalid:!!b["".concat(l).concat(n)]&&u["".concat(l).concat(n)]}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:b["".concat(l).concat(n)]})]}),Object(c.jsx)(m.a,{xs:12,md:1,children:Object(c.jsx)(g.b,{onClick:F(n,t,a,j,O)})})]})},R=function(e){var t=e.index,a=e.nameFrom,n=e.nameTo,r=e.nameMapping,o=e.setNameMapping,s=e.setFieldValue,i=e.errors,l=e.touched,d=e.setTouched;return Object(c.jsxs)(x.a.Row,{className:"mb-2 mt-2",children:[Object(c.jsxs)(m.a,{xs:12,md:5,children:[Object(c.jsx)(x.a.Control,{type:"text",name:"".concat(a).concat(t),isValid:l["".concat(a).concat(t)]&&!i["".concat(a).concat(t)],isInvalid:!!i["".concat(a).concat(t)]&&l["".concat(a).concat(t)],placeholder:"Actual Clade Name",onChange:q(t,a,o,s),value:r[t][a]||""}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:i["".concat(a).concat(t)]})]}),Object(c.jsxs)(m.a,{xs:12,md:5,children:[Object(c.jsx)(x.a.Control,{type:"text",name:"".concat(n).concat(t),isValid:l["".concat(n).concat(t)]&&!i["".concat(n).concat(t)],isInvalid:!!i["".concat(n).concat(t)]&&l["".concat(n).concat(t)],placeholder:"Desired Clade Name",onChange:q(t,n,o,s),value:r[t][n]||""}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:i["".concat(n).concat(t)]})]}),Object(c.jsx)(m.a,{xs:12,md:1,children:Object(c.jsx)(g.b,{onClick:F(t,r,o,s,d)})})]},t)},S=a(117),T=a.n(S);var w=function(e){var t=e.fieldName,a=e.setNwkFile,n=e.setFieldValue,r=e.errors,o=e.touched;return Object(c.jsx)("div",{className:"".concat(T.a.color," mr-4 ml-4"),children:Object(c.jsxs)("div",{className:T.a.files,children:[Object(c.jsx)("label",{children:"Upload Your File "}),Object(c.jsx)("input",{type:"file",multiple:!1,className:r[t]&&o[t]?T.a.error:"",onChange:function(e){a(e.target.files[0]),n(t,e.target.files[0])}})]})})},P=function(e){var t=e.colorDelineator,a=e.colorDelineatorValue,n=e.offset,r=e.offsetValue,o=e.rootOn,s=e.rootOnValue,i=e.quotes,l=e.quotesValue,d=e.setColorDelineator,j=e.setOffset,b=e.setRootOn,u=e.setQuotes,O=e.setFieldValue,h=e.errors,f=e.touched,v=function(e,t,a){return function(c){"form-check-input"===c.target.className?(t(c.target.checked),a(e,c.target.checked)):(t(c.target.value),a(e,c.target.value))}};return Object(c.jsxs)(x.a.Group,{as:m.a,xs:12,md:6,children:[Object(c.jsx)(x.a.Label,{children:"Color Delineator"}),Object(c.jsx)(x.a.Control,{"aria-describedby":"colorDelineator",type:"text",placeholder:"Color Delineator",value:t,onChange:v(a,d,O),isValid:!h[a]&&f[a],isInvalid:!!h[a]&&f[a]}),Object(c.jsx)(x.a.Text,{id:"colorDelineator",muted:!0,children:'Use "color=" for rapidNj and fastTree files, "____color__" for iqTree'}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:h[a]}),Object(c.jsx)(x.a.Label,{children:"Color Offset"}),Object(c.jsx)(x.a.Control,{"aria-describedby":"colorOffset",type:"text",placeholder:"Offset",value:n,onChange:v(r,j,O),isValid:!h[r]&&f[r],isInvalid:!!h[r]&&f[r]}),Object(c.jsx)(x.a.Text,{id:"colorOffset",muted:!0,children:"Number of characters to skip from the back when extracting color code"}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:h[r]}),Object(c.jsx)(x.a.Label,{children:"Root On"}),Object(c.jsx)(x.a.Control,{type:"text",placeholder:"Clade to Root On",value:o,onChange:v(s,b,O),isValid:!h[s]&&f[s],isInvalid:!!h[s]&&f[s]}),Object(c.jsx)(x.a.Control.Feedback,{type:"invalid",children:h[s]}),Object(c.jsx)(x.a.Check,{type:"checkbox",name:l,label:"Is Sequence Name Quoted?",checked:i,onChange:v(l,u,O),isInvalid:!!h[l],feedback:h[l]})]})},M="clade",I="color",L="minDensity",G="maxDensity",E="minCoverage",A="maxCoverage",J="nameFrom",U="nameTo",H="nwkFile",K="quotes",Q="colorDelineator",X="colorOffset",z="rootOn";var B=function(e){var t,a,n,o,s=e.setResults,l=r.a.useRef((t={},Object(O.a)(t,M,p.e().typeError("Clade must be a filled in").required("Required")),Object(O.a)(t,I,p.e().required().matches(/^#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})/,{excludeEmptyString:!0})),Object(O.a)(t,L,p.c().typeError("Min Density must be a number between 0 and 100").required("Required").positive().min(0,"Number must more than 0%").max(100,"Number must be less than 100%")),Object(O.a)(t,G,p.c().typeError("Max Density must be a number between 0 and 100").required("Required").positive().min(0,"Number must more than 0%").max(100,"Number must be less than 100%")),Object(O.a)(t,E,p.c().typeError("Min Coverage must be a number between 0 and 100").required("Required").positive().min(0,"Number must more than 0%").max(100,"Number must be less than 100%")),Object(O.a)(t,A,p.c().typeError("Max Coverage must be a number between 0 and 100").required("Required").positive().min(0,"Number must more than 0%").max(100,"Number must be less than 100%")),Object(O.a)(t,J,p.e().typeError("Required").required("Required")),Object(O.a)(t,U,p.e().typeError("Required").required("Required")),Object(O.a)(t,K,p.a()),Object(O.a)(t,Q,p.e().required("Required")),Object(O.a)(t,X,p.c().typeError("Color Offset must be a number. Should be between -5,5").required("Required")),Object(O.a)(t,z,p.e().required("Required")),Object(O.a)(t,H,p.b().required("Required")),t)),j=Object(d.f)(),b=r.a.useRef((a={},Object(O.a)(a,M,""),Object(O.a)(a,I,"#eeaabb"),Object(O.a)(a,L,""),Object(O.a)(a,G,""),Object(O.a)(a,E,""),Object(O.a)(a,A,""),a)),C=r.a.useRef((n={},Object(O.a)(n,J,""),Object(O.a)(n,U,""),n)),_=r.a.useState({0:{clade:"G_",color:"#fdb3b3",minDensity:.1,maxDensity:1,minCoverage:.6,maxCoverage:1},1:{clade:"GH_",color:"#feab8d",minDensity:.1,maxDensity:1,minCoverage:.6,maxCoverage:1},2:{clade:"GV_",color:"#f08bb5",minDensity:.9,maxDensity:1,minCoverage:.88,maxCoverage:1},3:{clade:"GR_",color:"#fe8d8d",minDensity:.9,maxDensity:1,minCoverage:.85,maxCoverage:1},4:{clade:"S_",color:"#b3ffb3",minDensity:.9,maxDensity:1,minCoverage:.5,maxCoverage:1},5:{clade:"V_",color:"#ffddff",minDensity:.9,maxDensity:1,minCoverage:.5,maxCoverage:1}}),k=Object(i.a)(_,2),D=k[0],N=k[1],F=r.a.useState({0:{nameFrom:"Gn_",nameTo:"G_"},1:{nameFrom:"GRn_",nameTo:"GR_"},2:{nameFrom:"GHn_",nameTo:"GH_"},3:{nameFrom:"GVn_",nameTo:"GV_"}}),q=Object(i.a)(F,2),S=q[0],T=q[1],B=r.a.useState("color="),Y=Object(i.a)(B,2),W=Y[0],Z=Y[1],$=r.a.useState(-1),ee=Object(i.a)($,2),te=ee[0],ae=ee[1],ce=r.a.useState("S_"),ne=Object(i.a)(ce,2),re=ne[0],oe=ne[1],se=r.a.useState(!1),ie=Object(i.a)(se,2),le=ie[0],de=ie[1],je=r.a.useState(""),be=Object(i.a)(je,2),ue=be[0],Oe=be[1],xe=r.a.useState(p.d()),me=Object(i.a)(xe,2),he=me[0],fe=me[1],ve=function(e){return function(){for(var t=Object.keys(D).length,a=0,c=Object.keys(D[t-1]||{});a<c.length;a++){var n=c[a];e("".concat(n).concat(t),b.current[n])}N((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(O.a)({},t,b.current))}))}},pe=function(e){return function(){for(var t=Object.keys(S).length,a=0,c=Object.keys(S[t-1]||{});a<c.length;a++){var n=c[a];e("".concat(n).concat(t),C.current[n])}T((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(O.a)({},t,C.current))}))}};r.a.useEffect((function(){fe(p.d(Object.keys(l.current).reduce((function(e,t){if([M,I,L,G,E,A].includes(t))for(var a=0;a<Object.keys(D).length;a++)e["".concat(t).concat(a)]=l.current[t];else if([J,U].includes(t))for(var c=0;c<Object.keys(S).length;c++)e["".concat(t).concat(c)]=l.current[t];else e[t]=l.current[t];return e}),{})))}),[D,S]);var ge=function(e,t){console.log("values :>> ",t);var a=new FormData;a.append("file",ue),a.append("clade_del",JSON.stringify(D)),a.append("name_mapping",JSON.stringify(S)),a.append("color_delineator",t.colorDelineator),a.append("root_on",t.rootOn),a.append("quoted",t.quotes),a.append("offset",t.colorOffset),j.push("/loading"),function(e){return y.a.post("https://mendel3.bii.a-star.edu.sg/METHODS/corona/current/cgi-bin/phyloTree/cgi_tree.py",e)}(a).then((function(e){console.log("response :>> ",e),j.push("/results"),s(e.data)})),e(!1)};return Object(c.jsx)(v.a,{validationSchema:he,initialValues:Object.values(S).reduce((function(e,t,a){for(var c=0,n=Object.keys(t);c<n.length;c++){var r=n[c];e["".concat(r).concat(a)]=t[r]}return e}),Object.values(D).reduce((function(e,t,a){for(var c=0,n=Object.keys(t);c<n.length;c++){var r=n[c];e["".concat(r).concat(a)]=t[r]}return e}),(o={},Object(O.a)(o,K,le),Object(O.a)(o,Q,W),Object(O.a)(o,X,te),Object(O.a)(o,z,re),Object(O.a)(o,H,""),o))),onSubmit:function(e,t){var a=t.setSubmitting;ge(a,e)},children:function(e){var t=e.handleSubmit,a=e.setFieldValue,n=e.setTouched,r=e.touched,o=(e.values,e.isValid,e.isSubmitting),s=e.errors;return Object(c.jsx)(f.a,{children:Object(c.jsxs)(x.a,{onSubmit:t,children:[Object(c.jsxs)(x.a.Group,{as:m.a,xs:12,children:[Object(c.jsx)(x.a.Label,{children:"Clade Colouring Properties"}),Object(c.jsxs)(x.a.Row,{children:[Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:2,children:"Clade"}),Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:1,children:"Color"}),Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:2,children:"Min Density"}),Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:2,children:"Max Density"}),Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:2,children:"Min Coverage"}),Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:2,children:"Max Coverage"})]}),Object.keys(D).map((function(e){return Object(c.jsx)(V,{cladeProperties:D,setCladeProperties:N,index:e,clade:M,minDensity:L,maxDensity:G,minCoverage:E,maxCoverage:A,color:I,setFieldValue:a,errors:s,touched:r,setTouched:n},e)})),Object(c.jsxs)(h.a,{onClick:ve(a),variant:"light",children:[Object(c.jsx)(g.a,{})," Add Field"]})]}),Object(c.jsxs)(x.a.Row,{children:[Object(c.jsxs)(x.a.Group,{as:m.a,xs:12,md:6,children:[Object(c.jsx)(x.a.Label,{children:"Clade Name Remapping"}),Object(c.jsxs)(x.a.Row,{children:[Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:5,children:"From:"}),Object(c.jsx)(x.a.Label,{as:m.a,xs:12,md:5,children:"To:"})]}),Object.keys(S).map((function(e){return Object(c.jsx)(R,{index:e,nameFrom:J,nameTo:U,nameMapping:S,setNameMapping:T,setFieldValue:a,errors:s,touched:r,setTouched:n},e)})),Object(c.jsxs)(h.a,{onClick:pe(a),variant:"light",children:[Object(c.jsx)(g.a,{})," Add Field"]})]}),Object(c.jsx)(P,{colorDelineatorValue:Q,colorDelineator:W,offsetValue:X,offset:te,rootOnValue:z,rootOn:re,quotesValue:K,quotes:le,setColorDelineator:Z,setOffset:ae,setRootOn:oe,setQuotes:de,setFieldValue:a,errors:s,touched:r})]}),Object(c.jsx)(w,{fieldName:H,setNwkFile:Oe,setFieldValue:a,errors:s,touched:r}),Object(c.jsx)(h.a,{type:"submit",disabled:o,children:o?"submit":"Submit"})]})})}})},Y=a(203),W=a(198),Z=a.n(W),$=a(201),ee=a(57),te=a.n(ee);function ae(e){var t=e.tree;return Object(c.jsx)("div",{children:Object(c.jsx)("img",{src:"data:image/svg+xml;base64,".concat(btoa(t))})})}function ce(e){var t=e.coverageDetails,a=r.a.useState(!1),n=Object(i.a)(a,2),o=n[0],s=n[1];return Object(c.jsxs)("div",{className:te.a.overlay,children:[Object(c.jsx)(h.a,{variant:"outline-light",onClick:function(){return s(!o)},"aria-controls":"coverage-collapse","aria-expanded":o,children:"Show Details"}),Object(c.jsx)($.a,{in:o,children:Object(c.jsx)("div",{className:te.a.textContainer,children:t.map((function(e,t){return Object(c.jsx)("p",{className:te.a.text,children:e},t)}))})})]})}var ne=function(e){var t=e.results;if(console.log("results :>> ",t),!t)return Object(c.jsx)("div",{className:te.a.errorText,children:"Nothing to see here"});if(t.error){var a=t.error.split("\n").map((function(e){return Object(c.jsx)("div",{className:te.a.errorText,children:e})}));return Object(c.jsx)("div",{className:te.a.errorContainer,children:a})}if("string"===typeof t)return Object(c.jsx)("div",{children:Z()(t)});var n=[t[0].split("\n")[1]].concat(Object(Y.a)(t[0].split("\n").slice(3)));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(ce,{coverageDetails:n}),Object(c.jsx)(ae,{tree:t[1][0]})]})},re=a(199),oe=a(118),se=a.n(oe),ie=function(){var e="This will take a while! Grab some Coffee",t=r.a.useState(e),a=Object(i.a)(t,2),n=a[0],o=a[1];return r.a.useEffect((function(){setInterval((function(){o((function(t){return t.length>43?e:t.concat(".")}))}),2e3)}),[]),Object(c.jsx)("div",{className:se.a.container,children:Object(c.jsxs)(m.a,{children:[Object(c.jsx)("div",{className:se.a.spinner,children:Object(c.jsx)(re.a,{as:"span",animation:"border",role:"status",variant:"dark"})}),Object(c.jsx)("p",{className:se.a.text,children:n})]})})};var le=function(){var e=r.a.useState(""),t=Object(i.a)(e,2),a=t[0],n=t[1];return Object(c.jsxs)(l.a,{basename:"/METHODS/corona/current/phyloTreeMaker/build",children:[Object(c.jsx)(l.b,{to:"/",style:{textDecoration:"none"},children:Object(c.jsx)("h1",{className:b.a.title,children:"Phylo Tree Maker"})}),Object(c.jsxs)(d.c,{children:[Object(c.jsx)(d.a,{exact:!0,path:"/",children:Object(c.jsx)(B,{setResults:n})}),Object(c.jsx)(d.a,{exact:!0,path:"/results",children:Object(c.jsx)(ne,{results:a})}),Object(c.jsx)(d.a,{exact:!0,path:"/loading",children:Object(c.jsx)(ie,{})}),Object(c.jsx)(d.a,{path:"*",children:Object(c.jsx)("div",{children:"404 Page not Found."})})]})]})},de=(a(378),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,383)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,o=t.getTTFB;a(e),c(e),n(e),r(e),o(e)}))});a(379);s.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(le,{})}),document.getElementById("root")),de()},57:function(e,t,a){e.exports={overlay:"resultPage_overlay__1Ld4b",text:"resultPage_text__eJF0z",textContainer:"resultPage_textContainer__3prwv",errorContainer:"resultPage_errorContainer__3YJPd",errorText:"resultPage_errorText__1wzKb"}},87:function(e,t,a){e.exports={color:"colorPicker_color__3CPJt",swatch:"colorPicker_swatch__1XK93",popover:"colorPicker_popover__1Ik58",cover:"colorPicker_cover__2vwyA"}}},[[380,1,2]]]);
//# sourceMappingURL=main.ea259c84.chunk.js.map